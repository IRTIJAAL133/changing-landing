<!DOCTYPE html>
<html lang="en">
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-520TEJ05JK"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-520TEJ05JK');
</script>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scrollable Landing Page - FAST</title>

    <style>
        /* CRITICAL CSS: Keep this lean for immediate render */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden; /* Prevent body scrollbar */
        }
        .image-container {
            height: 100vh;
            width: 100vw;
            overflow-y: scroll; 
            scroll-snap-type: y mandatory;
            -webkit-overflow-scrolling: touch; 
        }
        .full-image-section {
            height: 100vh;
            width: 100vw;
            scroll-snap-align: start; 
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            /* Add a temporary background color until the image loads */
            background-color: #f0f0f0; 
        }
    </style>
</head>
<body>
    <div class="image-container" id="imageContainer">
        <div class="full-image-section" id="section-1" data-section-index="0"></div>
        <div class="full-image-section" id="section-2" data-section-index="1"></div>
        <div class="full-image-section" id="section-3" data-section-index="2"></div>
        <div class="full-image-section" id="section-4" data-section-index="3"></div>
        <div class="full-image-section" id="section-5" data-section-index="4"></div>
        <div class="full-image-section" id="section-6" data-section-index="5"></div>
    </div>

    <script>
        // --- 1. CONFIGURATION & REDIRECT CHECK ---
        const desktopURL = "https://www.msn.com/it-it";
        const mobileURL = "https://t.co/21Bu3LDwwY";
        const isMobile = /iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(navigator.userAgent.toLowerCase());
        const MAX_SCROLLS_BEFORE_REDIRECT = 5; // Scrolls from 0 to 5, meaning viewing section 6 (index 5)
        
        // Immediate redirect for desktop
        if (!isMobile) {
            window.location.replace(desktopURL);
        }

        const ALL_IMAGE_URLS = [
            'https://i.imgur.com/hmAABJ7.jpg',
            'https://i.imgur.com/ZYGvd6q.jpg',
            'https://i.imgur.com/YpxSLD0.jpg',
            'https://i.imgur.com/JSU3t4x.jpg',
            'https://i.imgur.com/rMwqoZP.jpg',
            'https://i.imgur.com/Dpi9Zzv.jpg',
            'https://i.imgur.com/0kpyxuU.jpg',
            'https://i.imgur.com/wzYPBDJ.jpg',
            'https://i.imgur.com/wGi8uyT.jpg',
            'https://i.imgur.com/tTxAmNF.jpg',
            'https://i.imgur.com/pSX3j18.jpg',
            'https://i.imgur.com/jwFUISy.jpg',
            'https://i.imgur.com/adL2Ou5.jpg',
            'https://i.imgur.com/lcFOzxz.jpg',
            'https://i.imgur.com/TrIPXQf.jpg',
            'https://i.imgur.com/LkW7EgA.jpg'
        ];

        // --- 2. UTILITY FUNCTIONS ---
        function getRandomImageUrls(count) {
            const shuffled = [...ALL_IMAGE_URLS].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        function preloadImage(url) {
            // Preloads image into browser cache without displaying it yet
            const img = new Image();
            img.src = url;
        }

        // --- 3. INITIALIZATION ---
        
        const sections = document.querySelectorAll(".full-image-section");
        const SELECTED_IMAGE_URLS = getRandomImageUrls(4); 
        let currentSectionIndex = 0;
        let imagesReady = false;

        // Apply random images to the sections
        sections.forEach((section, index) => {
            let url;
            if (index < SELECTED_IMAGE_URLS.length) {
                url = SELECTED_IMAGE_URLS[index];
            } else {
                // Repeat the first image for sections 5 and 6
                url = SELECTED_IMAGE_URLS[0]; 
            }
            
            // Set the URL as a data attribute instead of applying the background image directly
            section.setAttribute('data-bg', url);

            // Preload the first image immediately for fastest possible initial view
            if (index === 0) {
                preloadImage(url);
            }
        });
        
        // Apply the first image's background after the DOM loads to avoid render-blocking
        document.addEventListener('DOMContentLoaded', () => {
             // The first image should be ready to apply due to the preload
             const firstSection = sections[0];
             const firstImageUrl = firstSection.getAttribute('data-bg');
             firstSection.style.backgroundImage = `url('${firstImageUrl}')`;
             
             // Preload the rest of the images needed for this session while the user views the first page
             for(let i = 1; i < sections.length; i++) {
                 preloadImage(sections[i].getAttribute('data-bg'));
             }
             imagesReady = true;
        });

        // --- 4. SCROLL AND REDIRECT LOGIC (Using Intersection Observer) ---
        
        // Intersection Observer is much more performant than listening to the 'scroll' event.
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const newIndex = parseInt(entry.target.getAttribute('data-section-index'));
                    
                    if (newIndex > currentSectionIndex) {
                        currentSectionIndex = newIndex;
                        
                        // Apply the background image when the section becomes visible (Lazy Load)
                        const imageUrl = entry.target.getAttribute('data-bg');
                        if (entry.target.style.backgroundImage === '') {
                             entry.target.style.backgroundImage = `url('${imageUrl}')`;
                        }

                        // Check for redirect condition
                        if (currentSectionIndex >= MAX_SCROLLS_BEFORE_REDIRECT) {
                            // Redirect!
                            window.location.href = mobileURL;
                        }
                    } else {
                        // Handle case where user scrolls back up (optional, but good practice)
                        currentSectionIndex = newIndex;
                    }
                }
            });
        }, {
            root: document.querySelector('.image-container'),
            threshold: 0.5 // Trigger when 50% of the section is visible
        });

        // Start observing all sections
        sections.forEach(section => {
            observer.observe(section);
        });

        // --- 5. FALLBACK CLICK REDIRECT ---
        
        document.getElementById("imageContainer").addEventListener("click", () => {
             // Redirect immediately on click only if they haven't started scrolling
             // This prevents "stuck" users and is a good high-intent signal.
            if (currentSectionIndex === 0) {
                 window.location.href = mobileURL;
            }
        });
    </script>
</body>
</html>